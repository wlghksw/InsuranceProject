<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>ê±°ë¶ì´ ë³´í—˜ - ë³´í—˜ë£Œ ê³„ì‚°ê¸°</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"/>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; padding-top: 80px; background-color: #f0f2f5; }
        .custom-navbar { background-color: #ffffff; border-bottom: 1px solid #e0e0e0; padding: 1rem 1.5rem; position: fixed; width: 100%; top: 0; z-index: 1000; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .custom-navbar .navbar-brand { font-weight: 700; color: #17ec42; font-size: 1.8rem; }
        .custom-navbar .nav-link { color: #555; font-weight: 500; margin-right: 1.5rem; }
        .custom-navbar .nav-link:hover { color: #17ec42; }
        .info-panel { background: linear-gradient(135deg, #17ec42, #12b835); color: white; padding: 50px 40px; border-radius: 0.5rem 0 0 0.5rem; display: flex; flex-direction: column; justify-content: center; }
        .info-content { text-align: left; }
        .info-icon { margin-bottom: 20px; }
        .info-title { font-size: 2.5rem; font-weight: 700; line-height: 1.3; }
        .info-text { font-size: 1.1rem; opacity: 0.9; margin-top: 15px; }
        .calculator-panel { background: #ffffff; padding: 50px 40px; border-radius: 0 0.5rem 0.5rem 0; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .calculator h4 { font-weight: 700; color: #333; text-align: left; margin-bottom: 1rem; }
        .input-group-custom { margin-bottom: 20px; text-align: left; }
        .input-group-custom label { margin-bottom: 8px; color: #555; font-weight: 500; font-size: 0.9rem; }
        .calculator-panel button { padding: 12px; border: none; background-color: #17ec42; color: white; font-size: 1.1rem; font-weight: 700; border-radius: 5px; cursor: pointer; transition: background-color 0.3s; margin-top: 10px; }
        .calculator-panel button:hover { background-color: #14c938; }
        #result { margin-top: 30px; font-size: 1.25rem; font-weight: bold; color: #d9534f; text-align: center; padding: 15px; background-color: #f8f9fa; border-radius: 5px; min-height: 60px; }
        @media (max-width: 991.98px) {
            .info-panel { border-radius: 0.5rem 0.5rem 0 0; }
            .calculator-panel { border-radius: 0 0 0.5rem 0.5rem; }
        }
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg custom-navbar">
    <div class="container-fluid">
        <a class="navbar-brand" href="/main">ğŸ¢ê±°ë¶ì´ ë³´í—˜</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item"><b><a class="nav-link" href="/service_intro">ì„œë¹„ìŠ¤ ì†Œê°œ</a></b></li>
                <li class="nav-item"><b><a class="nav-link" href="/user/my_insurance">ë‚´ ë³´í—˜ì°¾ê¸°</a></b></li>
                <li class="nav-item"><b><a class="nav-link" href="/calculator">ë³´í—˜ë£Œ ê³„ì‚°ê¸°</a></b></li>
                <li class="nav-item d-flex align-items-center">
                    <div class="input-group">
                        <input type="search" class="form-control form-control-sm" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥" aria-label="Search">
                        <button class="btn btn-outline-secondary btn-sm" type="button"><i class="fas fa-search"></i></button>
                    </div>
                </li>
            </ul>
            <ul class="navbar-nav">
                {{#user}}
                    <li class="nav-item"><span class="nav-link text-dark">ì•ˆë…•í•˜ì„¸ìš”. {{nickname}}ë‹˜</span></li>
                    <li class="nav-item">
                        <form action="/logout" method="post" class="d-inline">
                            <button type="submit" class="btn btn-outline-dark">ë¡œê·¸ì•„ì›ƒ</button>
                        </form>
                    </li>
                {{/user}}
                {{^user}}
                    <li class="nav-item"><a class="nav-link text-dark" href="/user/login">ë¡œê·¸ì¸</a></li>
                    <li class="nav-item"><a class="nav-link text-dark" href="/user/register">íšŒì›ê°€ì…</a></li>
                {{/user}}
            </ul>
        </div>
    </div>
</nav>

<div class="container my-5">
    <div class="row g-0">
        <div class="col-lg-5 info-panel">
            <div class="info-content">
                <div class="info-icon"><i class="fas fa-shield-alt fa-3x"></i></div>
                <h1 class="info-title">ë‚˜ì—ê²Œ ê¼­ ë§ëŠ”<br>ë³´í—˜ë£Œ ì•Œì•„ë³´ê¸°</h1>
                <p class="info-text">ëª‡ ê°€ì§€ ê°„ë‹¨í•œ ì •ë³´ë§Œìœ¼ë¡œ<br>ì£¼ìš” ë³´í—˜ ìƒí’ˆì˜ ì˜ˆìƒ ê¸ˆì•¡ì„<br>ë¹ ë¥´ê³  ì‰½ê²Œ í™•ì¸í•´ ë³´ì„¸ìš”.</p>
                <p class="info-text">ì˜ˆìƒ ë³´í—˜ë£ŒëŠ” ë‹¨ìˆœ ì°¸ê³ ìš©ìœ¼ë¡œ<br>ë³´í—˜ ê°€ì…ì‹œ ê¸ˆì•¡ì´ ìƒì´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            </div>
        </div>
        <div class="col-lg-7 calculator-panel">
            <div class="calculator">
                <h4>ë³´í—˜ ì¢…ë¥˜ ì„ íƒ</h4>
                <div class="input-group-custom">
                    <select id="insuranceType" class="form-select form-select-lg" onchange="toggleForm()">
                        <option value="cancer" selected>ì•”ë³´í—˜</option>
                        <option value="health">ì‹¤ì†ì˜ë£Œë³´í—˜</option>
                        <option value="protection">ë³´ì¥ì„±ë³´í—˜</option>
                        <option value="car">ìë™ì°¨ë³´í—˜</option>
                        <option value="travel">ì—¬í–‰ìë³´í—˜</option>
                        <option value="child">ì–´ë¦°ì´/íƒœì•„ë³´í—˜</option>
                        <option value="savings">ì €ì¶•ì„±ë³´í—˜</option>
                        <option value="annuity">ì—°ê¸ˆë³´í—˜</option>
                    </select>
                </div>
                <hr class="my-4">

                <div id="cancerForm" class="insurance-form"><div class="input-group-custom"><label for="cancer-age">ë‚˜ì´ ì…ë ¥ (ë‹¨ìœ„ : ì„¸)</label><input type="number" id="cancer-age" class="form-control" placeholder="ì˜ˆ: 35"></div><div class="input-group-custom"><label for="cancer-coverage">ì•” ì§„ë‹¨ë¹„ ì…ë ¥ (ë‹¨ìœ„ : ë§Œì›)</label><input type="number" id="cancer-coverage" class="form-control" placeholder="(ì…ë ¥ ì˜ˆ: 3000)"></div></div>
                <div id="healthForm" class="insurance-form" style="display:none;"><div class="input-group-custom"><label for="health-age">ë‚˜ì´ ì…ë ¥(ë‹¨ìœ„ : ì„¸)</label><input type="number" id="health-age" class="form-control" placeholder="ì˜ˆ: 40"></div><div class="input-group-custom"><label for="health-gender">ì„±ë³„ ì„ íƒ</label><select id="health-gender" class="form-select"><option value="male">ë‚¨ì„±</option><option value="female">ì—¬ì„±</option></select></div></div>
                <div id="protectionForm" class="insurance-form" style="display:none;"><div class="input-group-custom"><label for="protection-age">ë‚˜ì´ ì…ë ¥(ë‹¨ìœ„ : ì„¸)</label><input type="number" id="protection-age" class="form-control" placeholder="ì˜ˆ: 30"></div><div class="input-group-custom"><label for="protection-death-benefit">ì‚¬ë§ ë³´í—˜ê¸ˆ (ë‹¨ìœ„ : ë§Œì›)</label><input type="number" id="protection-death-benefit" class="form-control" placeholder="(ì…ë ¥ ì˜ˆ: 10000)"></div></div>
                <div id="carForm" class="insurance-form" style="display:none;"><div class="input-group-custom"><label for="car-age">ìš´ì „ì ë‚˜ì´ ì…ë ¥(ë‹¨ìœ„ : ì„¸)</label><input type="number" id="car-age" class="form-control" placeholder="ì˜ˆ: 30"></div><div class="input-group-custom"><label for="car-experience">ìš´ì „ ê²½ë ¥ ì…ë ¥ (ë‹¨ìœ„ : ë…„)</label><input type="number" id="car-experience" class="form-control" placeholder="ì˜ˆ: 5"></div></div>
                <div id="travelForm" class="insurance-form" style="display:none;"><div class="input-group-custom"><label for="travel-days">ì—¬í–‰ ê¸°ê°„ ì…ë ¥(ë‹¨ìœ„ : ì¼)</label><input type="number" id="travel-days" class="form-control" placeholder="(ì…ë ¥ ì˜ˆ: 20)"></div></div>
                <div id="childForm" class="insurance-form" style="display:none;"><div class="input-group-custom"><label for="child-age">ìë…€ ë‚˜ì´ ì…ë ¥(ë‹¨, íƒœì•„ëŠ” 0ìœ¼ë¡œ ì…ë ¥)(ë‹¨ìœ„ : ì„¸)</label><input type="number" id="child-age" class="form-control" placeholder="ì˜ˆ: 5"></div><div class="input-group-custom"><label for="child-plan">í”Œëœ ì„ íƒ</label><select id="child-plan" class="form-select"><option value="basic">ê¸°ë³¸ í”Œëœ</option><option value="premium">ê³ ê¸‰ í”Œëœ</option></select></div></div>
                <div id="savingsForm" class="insurance-form" style="display:none;"><div class="input-group-custom"><label for="savings-deposit">ì›” ë‚©ì…ì•¡ ì…ë ¥(ë‹¨ìœ„ : ë§Œì›)</label><input type="number" id="savings-deposit" class="form-control" placeholder="(ì…ë ¥ ì˜ˆ: 50)"></div><div class="input-group-custom"><label for="savings-years">ë‚©ì… ê¸°ê°„ ì…ë ¥ (ë‹¨ìœ„ : ë…„)</label><input type="number" id="savings-years" class="form-control" placeholder="(ì…ë ¥ ì˜ˆ: 10)"></div></div>
                <div id="annuityForm" class="insurance-form" style="display:none;"><div class="input-group-custom"><label for="annuity-deposit">ì›” ë‚©ì…ì•¡ ì…ë ¥(ë‹¨ìœ„ : ë§Œì›)</label><input type="number" id="annuity-deposit" class="form-control" placeholder="(ì…ë ¥ ì˜ˆ: 30)"></div><div class="input-group-custom"><label for="annuity-years">ë‚©ì… ê¸°ê°„ ì…ë ¥ (ë‹¨ìœ„ : ë…„)</label><input type="number" id="annuity-years" class="form-control" placeholder="(ì…ë ¥ ì˜ˆ: 20)"></div></div>

                <button class="btn w-100" onclick="calculatePremium()">ì˜ˆìƒ ë³´í—˜ë£Œ í™•ì¸í•˜ê¸°</button>
                <div id="result"><p>ì›” ì˜ˆìƒ ë³´í—˜ë£Œ(ë‹¨ìœ„ : ì›): </p></div>
            </div>
        </div>
    </div>
</div>

<footer class="bg-dark text-white text-center py-3">
    <p class="mb-0">Â©2025 Turtle Insurance. All Rights Reserved.</p>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    function toggleForm() {
        const selectedType = document.getElementById('insuranceType').value;
        document.querySelectorAll('.insurance-form').forEach(form => form.style.display = 'none');
        document.getElementById(selectedType + 'Form').style.display = 'block';
        const resultLabel = document.querySelector('#result p');

        if (selectedType === 'annuity') {
            resultLabel.textContent = 'ë§Œê¸° ì‹œ ì˜ˆìƒ ì—°ê¸ˆì•¡: ';
        } else if (selectedType === 'savings') {
            resultLabel.textContent = 'ë§Œê¸° ì‹œ ì˜ˆìƒ í™˜ê¸‰ê¸ˆ: ';
        } else if (selectedType === 'travel') {
            resultLabel.textContent = 'ì¼ ì˜ˆìƒ ë³´í—˜ë£Œ: '; // 'travel'ì¼ ê²½ìš° ë¼ë²¨ ë³€ê²½
        } else {
            resultLabel.textContent = 'ì›” ì˜ˆìƒ ë³´í—˜ë£Œ: ';
        }
    }
    async function calculatePremium() {
        const insuranceType = document.getElementById('insuranceType').value;
        const resultDiv = document.getElementById('result');
        let requestDto = { type: insuranceType };
        let isValid = true;
        if (insuranceType === 'cancer') {
            const age = document.getElementById('cancer-age').value; const coverage = document.getElementById('cancer-coverage').value;
            if (!age || !coverage) isValid = false;
            requestDto.age = parseInt(age); requestDto.coverage = parseInt(coverage);
        } else if (insuranceType === 'health') {
            const age = document.getElementById('health-age').value; const gender = document.getElementById('health-gender').value;
            if (!age) isValid = false;
            requestDto.age = parseInt(age); requestDto.gender = gender;
        } else if (insuranceType === 'protection') {
            const age = document.getElementById('protection-age').value; const benefit = document.getElementById('protection-death-benefit').value;
            if (!age || !benefit) isValid = false;
            requestDto.age = parseInt(age); requestDto.deathBenefit = parseInt(benefit);
        } else if (insuranceType === 'car') {
            const age = document.getElementById('car-age').value; const experience = document.getElementById('car-experience').value;
            if (!age || !experience) isValid = false;
            requestDto.age = parseInt(age); requestDto.experience = parseInt(experience);
        } else if (insuranceType === 'travel') {
            const days = document.getElementById('travel-days').value;
            if (!days) isValid = false;
            requestDto.days = parseInt(days);
        } else if (insuranceType === 'child') {
            const age = document.getElementById('child-age').value; const plan = document.getElementById('child-plan').value;
            if (age === null || age === '') isValid = false;
            requestDto.age = parseInt(age); requestDto.plan = plan;
        } else if (insuranceType === 'savings' || insuranceType === 'annuity') {
            const formType = insuranceType;
            const deposit = document.getElementById(formType + '-deposit').value;
            const years = document.getElementById(formType + '-years').value;
            if (!deposit || !years) isValid = false;
            requestDto.deposit = parseInt(deposit) * 10000;
            requestDto.years = parseInt(years);
        }
        if (!isValid) {
            resultDiv.innerHTML = '<p style="color: red;">ëª¨ë“  í•„ìˆ˜ í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>'; return;
        }
        try {
            const response = await fetch('/api/calculate', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(requestDto) });
            if (response.ok) {
                const data = await response.json();
                let resultLabelText;

                if (insuranceType === 'annuity') {
                    resultLabelText = 'ë§Œê¸° ì‹œ ì˜ˆìƒ ì—°ê¸ˆì•¡: ';
                } else if (insuranceType === 'savings') {
                    resultLabelText = 'ë§Œê¸° ì‹œ ì˜ˆìƒ í™˜ê¸‰ê¸ˆ: ';
                } else if (insuranceType === 'travel') {
                    resultLabelText = 'ì¼ ì˜ˆìƒ ë³´í—˜ë£Œ: '; // 'travel'ì¼ ê²½ìš° ë¼ë²¨ ë³€ê²½
                } else {
                    resultLabelText = 'ì›” ì˜ˆìƒ ë³´í—˜ë£Œ: ';
                }
                resultDiv.innerHTML = `<p>${resultLabelText}${data.premium.toLocaleString()}ì›</p>`;
            } else {
                resultDiv.innerHTML = `<p style="color: red;">ê³„ì‚° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>`;
            }
        } catch (error) {
            resultDiv.innerHTML = '<p style="color: red;">ì„œë²„ì™€ í†µì‹ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
        }
    }
</script>
</body>
</html>